---
title: \sffamily{\bfseries{\LARGE Criminal History Records Paper Step 3 (Case Studies)}}
geometry: "left=.5in,right=.5in,top=.75in,bottom=.75in"
author: "Steven J. Pierce"
output:
 pdf_document:
   latex_engine: xelatex
   number_sections: true
   toc: yes
   toc_depth: 3
   includes:
     in_header: "compact-title.tex"
urlcolor: blue
header-includes:
- \usepackage{fancyhdr}
- \usepackage[yyyymmdd,hhmmss]{datetime}
- \usepackage{lastpage}
- \usepackage{fontspec}
- \defaultfontfeatures{Ligatures=TeX}
- \usepackage[font={small}, margin=1cm, skip=2pt]{caption}
- \usepackage{url}
- \usepackage{floatrow}
- \floatplacement{figure}{!ht}
- \floatplacement{table}{!ht}
- \usepackage{placeins}
- \usepackage{booktabs}
- \usepackage{longtable}
- \usepackage{dcolumn}
- \usepackage{titling}
- \usepackage{threeparttable}
- \usepackage{threeparttablex}
- \pretitle{\begin{center}\LARGE\bfseries}
- \posttitle{\end{center}}
- \pagestyle{fancy}
- \lhead{SSA CHR Paper Step 3 Case Studies}
- \rhead{\today\ \currenttime}
- \lfoot{\texttt{\small \detokenize{`r sub(".Rmd", ".pdf", knitr:::current_input(dir = FALSE))`}}} 
- \cfoot{ }
- \fancyfoot[R]{\thepage\ of \pageref*{LastPage}}
- \renewcommand{\headrulewidth}{0.4pt}
- \renewcommand{\footrulewidth}{0.4pt}
- \fancypagestyle{plain}{\pagestyle{fancy}}
---

********************************************************************************  
\FloatBarrier

# Purpose
This file extracts case study summaries of the criminal history data associated 
with specific offenders from publicly archived data files (Campbell, 2019) to 
produce outputs for a descriptive paper about the criminal histories of
suspected serial sexual perpetrators.^[In this document, we use the terms
perpetrator and offender interchangeably. Both terms should be interpreted as
referring to individuals suspected of committing a crime but we occasionally
omit that qualifier for the sake of brevity.] The data come from Detroit, MI.

\FloatBarrier

# Setup
Set global R chunk options (local chunk options will over-ride global options). 
The method for creating a size option that controls font size in code chunks and
their text output is based on an answer to a question posted on   
[stackoverflow.com](https://stackoverflow.com/questions/25646333/code-chunk-font-size-in-rmarkdown-with-knitr-and-latex/46526740#46526740). 

``` {r global_options, cfsize = "footnotesize"}
# Create a custom chunk hook/option for controlling font size in chunk & output.
def.chunk.hook  <- knitr::knit_hooks$get("chunk")
knitr::knit_hooks$set(chunk = function(x, options) {
  x <- def.chunk.hook(x, options)
  ifelse(options$cfsize != "normalsize", paste0("\n \\", options$cfsize,"\n\n", 
                                              x, "\n\n \\normalsize"), x)
  })

# Global chunk options (over-ridden by local chunk options)
knitr::opts_chunk$set(include  = TRUE, echo = TRUE, error = TRUE, 
                      message = TRUE, warning = TRUE, cfsize = "footnotesize")
```

Load R packages that we need to get additional functions. 

``` {r load_packages}
library(here)             # for here()
library(dplyr)            # for %>%, filter(), group_by(), & summarise()
library(tidyr)            # for arrange(), filter(), group_by(), mutate(),  
                          # spread(), summarise(), %>%, etc. 
library(rmarkdown)        # for render()
library(knitr)            # for kable()
library(sjlabelled)       # For set_label(), get_label()
library(haven)            # for read_spss()
library(SSACHR)           # for rvlabel()
```

\FloatBarrier

# Load Data 
The chunk below loads the data saved by the prior script *Step_01_Data_Mgt.Rmd*.

```{r load_data}
load(file = here::here("./data/CHR_Data.RData"))
```

\FloatBarrier

# Notes About Offender Criminal Histories
Below, we present criminal histories for individual offenders. Each one starts
with a brief offender-level data record, then presents each incident in the 
offender's history as a separate section, with subsections for arrest offense, 
prosecutor charge, and adjudicated charge records associated with that incident.

In the offender-level record, the variables *NINC*, *NARR*, *NCHG*, *NJUD*, and
*NCON* are respectively counts of the total numbers of incident, arrest,
prosecutor charge, adjudicated charge records (any disposition), and convictions
(a subset of adjudicated charge records) associated with the offender.

In each incident-level record, there are a set of binary variables called 
*CSC_ARR*, *CSC_CHG*, *CSC_JUD*, and *CSC_CON*. These binary variables
respectively code whether the incident was associated with any criminal sexual 
conduct (CSC) arrest offenses, CSC prosecutor charges, adjudicated CSC charges
(any disposition), and CSC convictions (these are a subset of adjudicated CSC
charges). The additional *CSC_ANY* binary variable codes whether or not the
incident had any CSC records at all (regardless of whether they were arrest
offenses, prosecutor charges, or adjudicated charges). 

The offender's age is shown for various events: on the incident date (*OAgeI*),
at arrest (*OAgeA*), at prosecutor charge (*OAgeC*), and at adjudication 
(*OAgeJ*). 

In the arrest offense and prosecutor charge records, the *AMIMP* and *CMImp* 
variables are binary flags indicating whether or not the record was manually 
imputed (i.e., created to replace a missing record). These records were based 
on an experienced WCPO attorney's inferences about the likely arrest offense or
prosecutor charge after reviewing other available records for that incident. 

\FloatBarrier
\newpage

# Offender: OID = xxxx

```{r testing_new_functions}
getIIDs(oid = "0069", incidents = INCEW)
getINC(iid = "01648", incidents = INCEW)
getARRs(iid = "01648", arrests = ARREW)
getCHGs(iid = "01648", charges = CHGEW)
getCHGs(iid = "01681", charges = CHGEW)
getJUDs(iid = "01681", jcharges = JUDEW)
#showchr(oid = "xxxx", verbose = TRUE)
```


********************************************************************************
# Wrap Up

\FloatBarrier

## Project Information
These materials are scholarly products based on research funded by the following 
grant. 

Campbell, R., Pierce, S. J., & Sharma, D. (01/01/2015â€“12/31/2018). Serial sexual
assaults: A longitudinal examination of offending patterns using DNA evidence.
[NIJ Award # 2014-NE-BX-0006, Awarded, $699,533]. Sponsor: National Institute of
Justice. Location: Michigan State University, East Lansing, MI.

\FloatBarrier

## References
Campbell, R. (2019). *Serial sexual assaults: A longitudinal examination of
offending patterns using DNA evidence, Detroit, Michigan, 2009* [Data files,
codebooks, computer programs, and statistical output]. ICPSR37134-v1. Ann Arbor,
MI: Inter-university Consortium for Political and Social Research [distributor],
2019-02-28. Retrieved from: https://doi.org/10.3886/ICPSR37134.v1

\FloatBarrier

## Software Information
We use R Markdown to enhance reproducibility. Knitting the source R Markdown 
script *`r knitr:::current_input()`* generates this PDF file containing 
explanatory text, R code, plus R output (text and graphics).

- We used [RStudio](www.rstudio.org) `r rstudioapi::versionInfo()$version` to 
  work with R and R markdown files. The software chain looks like this:
  **Rmd file > RStudio > R > rmarkdown > knitr > pandoc > TinyTeX or MiKTeX > PDF file**.
- We recommend using [TinyTeX](https://yihui.org/tinytex/) to compile LaTeX files 
  into PDF files. However, it should be viable to use 
  [MiKTeX version 2.9](https://miktex.org) instead. 
- We used [pandoc](https://pandoc.org) `r pandoc_version()` for this 
  document. 

This document was generated using the following computational environment and 
dependencies: 

``` {r show_citations}
# If is_tineytex = TRUE, then we used TinyTex, otherwise we used MikTeX. 
tinytex:::is_tinytex()

# Get R and R package version numbers in use.
devtools::session_info()
```

The current Git commit details and status are:

```{r git_details, eval=TRUE}
# Store whether git2r is installed and we are in a git repository.
GitCheck <- "git2r" %in% installed.packages() & git2r::in_repository(path = ".")
cat(paste("GitCheck =", GitCheck, "\n"))

# What commit is this file at? 
if (GitCheck) git2r::repository(here::here())

# What is the repository status? 
if (GitCheck) git2r::status()
```
