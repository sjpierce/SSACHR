---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# SSACHR: Serial Sexual Assault Study Criminal History Records Paper Research Compendium
<!-- badges: start -->
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/cstatops)](https://CRAN.R-project.org/package=SSAlvmm)
<!-- badges: end -->

This package and corresponding GitHub repository are intended to enhance the
reproducibility of a research paper (**ADD CITATION!**) by serving as a research
compendium (Marwick, Boettiger, & Mullen, 2018). The principal investigator for
the study is Dr. Rebecca Campbell (Professor, Department of Psychology, Michigan
State University). The paper will present descriptive data about the criminal
histories of suspected serial sexual offenders using data from both criminal
history records and forensic DNA testing of sexual assault kits (SAKs).

## Installation

### Repository Location
The *SSACHR* package is only available from a *private* repository available on 
[GitHub](https://github.com/) at https://github.com/sjpierce/SSACHR. It will 
remain private until we are ready to release the code, which will likely
coincide with publication of the associated paper. After that, we will make it a
public repository.

If you use Git (Torvalds et al., 2020) and have a GitHub account, either clone
or fork and clone the package to your computer using the usual Git commands
(Bryan, 2018; Bryan et al., 2019, Chapters 28 and 32). Otherwise, manually
download a ZIP file and unzip its contents to a folder. Either way, the files
should end up in a folder called *SSACHR* on your computer. That folder is your
local copy of the repository.

Note that the package code uses relative rather than absolute folder path and
file name references. Moving or renaming subfolders and/or files may cause
problems. We have tested it only with the folder structure and file naming used
in the primary repository on GitHub.

### Install SSACHR to Your R Package Library
Parts of the *SSACHR* package rely on custom functions defined in the package
repository's *SSACHR/R* subfolder. The easiest way to use them is to 
install the package to your personal R package library. Downloading or cloning 
the repository files to your computer does not install that package into your R 
package library. It just creates your local copy of the repository files.

To install the package to your R package library, you have to either build and
install the package from those local files, or install it directly from GitHub.

Parts of the *SSACHR* package rely on functions from the *piercer* package, 
which is not yet available from [CRAN](https://CRAN.R-project.org). Releasing 
*piercer* on CRAN is a long-term goal but the development version can be 
obtained from a public [GitHub](https://github.com/) repository at 
https://github.com/sjpierce/piercer. The following code will install *devtools*,
*piercer*, and *SSACHR*. We use the *install_github()* function from *devtools*
to install the other two packages directly from the Github repositories. 

```r
install.packages("devtools")
devtools::install_github("sjpierce/piercer")
devtools::install_github("sjpierce/SSACHR")
```

```{r, echo = FALSE, eval = FALSE}
install.packages("devtools")
devtools::install_github("sjpierce/piercer")
devtools::install_github("sjpierce/SSACHR")
```

## Obtaining Data Files
The data files required by this package were deposited into the National Archive 
of Criminal Justice Data (Campbell, 2019). Please visit the web page for that 
[deposit at NACJD](https://doi.org/10.3886/ICPSR37134.v1) to download the files. 

After you have downladed the data from NACJD, unzip all the SPSS data files
(\*.sav) into the *SSACHR/inst/extdata* subfolder of your local repository. 
That should allow you to reproduce the analyses by re-running our scripts.

## Example
Text goes here. 

```{r example}
#library(SSAlvmm)
# Need to add example code
```

# Software Information
We use R Markdown to enhance reproducibility because it provides excellent 
support for generating dynamic reports (Mair, 2016). Knitting our R Markdown
scripts generates PDF output files containing explanatory text, R code, plus R
output (both text and graphics).

- We use [RStudio](www.rstudio.org) to work with R and R Markdown files. The 
  software chain looks like this:
  **Rmd file -> RStudio -> R -> knitr -> pandoc -> TinyTex -> PDF file**.
- A version of [pandoc](https://pandoc.org/) comes bundled with RStudio, but if 
  you want the most recent version, download it from https://pandoc.org/. 
- We recommend using [TinyTeX](https://yihui.org/tinytex/) to compile LaTeX 
  files produced by pandoc into PDF files. However, it may be viable to use 
  [MiKTeX](https://miktex.org) instead. 

# References
Bryan, J. (2018). Excuse me, do you have a moment to talk about version control? 
*The American Statistician, 72*(1), 20-27. 
[doi:10.1080/00031305.2017.1399928](https://doi.org/10.1080/00031305.2017.1399928)

Bryan, J., The STAT 545 TAs, & Hester, J. (2019). Happy Git and GitHub for the 
useR. Retrieved from https://happygitwithr.com

Campbell, R. (2019). *Serial sexual assaults: A longitudinal examination of 
offending patterns using DNA evidence, Detroit, Michigan, 2009* [Data files, 
codebooks, computer programs, and statistical output]. ICPSR37134-v1. Ann Arbor,
MI: Inter-university Consortium for Political and Social Research [distributor],
2019-02-28. Retrieved from: https://doi.org/10.3886/ICPSR37134.v1

Mair, P. (2016). Thou shalt be reproducible! A technology perspective.
*Frontiers in Psychology, 7*(1079), 1-17. 
[doi:10.3389/fpsyg.2016.01079](http://dx.doi.org/10.3389/fpsyg.2016.01079)

Marwick, B., Boettiger, C., & Mullen, L. (2018). Packaging data analytical work 
reproducibly using R (and friends). *The American Statistician, 72*(1), 80-88.
[doi:10.1080/00031305.2017.1375986](https://doi.org/10.1080/00031305.2017.1375986)

Torvalds, L., Hamano, J. C., & other contributors to the Git Project. (2020).
Git for Windows (Version 2.26.2) [Computer program]. Brooklyn, NY: Software 
Freedom Conservancy. Retrieved from https://git-scm.com

# Funding Support
This R package and repository are based on research supported by the following 
grant. 

Campbell, R., Pierce, S. J., & Sharma, D. (01/01/2015â€“12/31/2018). Serial 
sexual assaults: A longitudinal examination of offending patterns using DNA 
evidence. [NIJ Award # 2014-NE-BX-0006, Awarded, $699,533]. Sponsor: National 
Institute of Justice. Location: Michigan State University, East Lansing, MI.  

# Disclaimer
This research was supported by a grant from the National Institute of Justice, 
United States (2014-NE-BX-0006). The opinions or points of view expressed in 
this document (or any other document included in this R package and repository)
are solely those of the authors and do not reflect the official positions of any
participating organization or the U.S. Department of Justice. 

# Task List
* Improve this file. 
* Create a script to generate a data flow diagram. 
* Add citation for the manuscript in preparation to the reference list.
* Edit code pasted into `inst/Step_01_Data_mgt.Rmd` from previous 
  `CHR_Summary_Step01_2017-01.19.Rmd` script to use tidyverse style where
  feasible. 
* Add code to identify the date for the earliest SAK associated with each
  perpetrator and add a binary variable to each INC, ARR, CHG, and JUD record to
  show whether it was associated with an incident that occurred before versus 
  after that date. See 2020-04-08 email.
* Summarize CHRs before vs after perpetrator's earliest SAK date in addition to 
  overall. See 2020-04-08 email.
* Update dfsummary() to eliminate warning message when used with a data frame 
  that does not contain an IID variable. 
  
